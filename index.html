<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <title>–£–Ω—à–∏–∂ —Å—É—Ä—Ü–≥–∞–∞—è - –û–¥—Ç–æ–π —Ç–æ–≥–ª–æ–æ–º ‚≠ê</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f7fbff; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; padding: 20px; }
        .card { background: white; width: 90%; max-width: 950px; padding: 40px; border-radius: 50px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); text-align: center; border: 10px solid #48dbfb; }
        .score-board { font-size: 30px; font-weight: bold; color: #f0932b; margin-bottom: 20px; background: #fff; padding: 10px 30px; border-radius: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .word { display: inline-block; cursor: pointer; padding: 5px 15px; border-radius: 20px; transition: 0.3s; border-bottom: 4px dashed #f1f2f6; font-size: 46px; font-weight: 700; color: #2c3e50; margin: 8px; }
        .word.playing { background-color: #f9ca24; color: black; }
        .word.correct { background-color: #2ed573 !important; color: white !important; border-bottom-color: #1e8449; scale: 1.1; }
        .mic-btn { padding: 20px 50px; font-size: 24px; background: #eb4d4b; color: white; border: none; border-radius: 50px; cursor: pointer; margin-top: 30px; font-weight: bold; transition: 0.3s; }
        .mic-btn.active { background: #6ab04c; box-shadow: 0 0 20px #6ab04c; }
        #status { margin-top: 15px; color: #666; font-style: italic; font-size: 20px; }
        .star { position: fixed; font-size: 40px; pointer-events: none; animation: fly 1s forwards; }
        @keyframes fly { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-200px); opacity: 0; } }
    </style>
</head>
<body>

<div class="score-board">–û–Ω–æ–æ: <span id="score">0</span> ‚≠ê</div>

<div class="card">
    <div style="font-size: 100px;">üèá</div>
    <h1 id="title" class="word" onclick="playVoice('–ù–∞–∞–¥–∞–º', this)">–ù–∞–∞–¥–∞–º</h1>
    <div id="story-box" style="margin-top: 20px; line-height: 2.8; text-align: justify;"></div>
    
    <button id="mic-btn" class="mic-btn" onclick="startListening()">üé§ –ú–∏–Ω–∏–π —Ö—ç–ª—ç—Ö–∏–π–≥ —Å–æ–Ω—Å–æ–æ—Ä–æ–π</button>
    <div id="status">“Æ–≥ –¥—ç—ç—Ä –¥–∞—Ä–∂ —Å–æ–Ω—Å–æ–æ–¥, –º–∏–∫—Ä–æ—Ñ–æ–Ω –¥—ç—ç—Ä –¥–∞—Ä–∂ –¥–∞–≥–∞–∂ —Ö—ç–ª—ç—ç—Ä—ç–π.</div>
</div>

<script>
    const text = "–•“Ø–º“Ø“Ø—Å –Ω–∞–∞–¥–º–∞–∞—Ä —Ö—É—Ä–¥–∞–Ω –º–æ—Ä–∏–æ —É—Ä–∞–ª–¥—É—É–ª–∞–≤ –ú–∏–Ω–∏–π ”©–≤”©”© —Ö–æ—ë—Ä —à“Ø–¥–ª—ç–Ω —Å–æ–π—Å–æ–Ω –ê—Ö –¥“Ø“Ø —Ö–æ—ë—Ä —à“Ø–¥–ª—ç–Ω —É–Ω–∞–∞–¥ –Ω–∞–∞–¥–∞–º–¥ —É—Ä–∞–ª–¥–∞–≤ –ê—Ö—ã–Ω —É–Ω–∞—Å–∞–Ω —à“Ø–¥–ª—ç–Ω –∞–π—Ä–∞–≥–¥–∞–≤ –•—ç–Ω —Ö—ç–Ω —Ö—É—Ä–¥–∞–Ω —à“Ø–¥–ª—ç–Ω —É–Ω–∞–≤";
    let score = 0;
    let currentWordElement = null;

    // –°–æ–Ω—Å–æ—Ö —Å–∏—Å—Ç–µ–º (Speech Recognition)
    const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new Recognition();
    recognition.lang = 'mn-MN';
    recognition.interimResults = false;

    function startApp() {
        const container = document.getElementById('story-box');
        text.split(' ').forEach(word => {
            const span = document.createElement('span');
            span.className = 'word';
            span.innerText = word + ' ';
            span.onclick = () => {
                currentWordElement = span;
                playVoice(word, span);
            };
            container.appendChild(span);
        });
    }

    function playVoice(w, el) {
        window.speechSynthesis.cancel();
        el.classList.add('playing');
        const utterance = new SpeechSynthesisUtterance(w);
        const voices = window.speechSynthesis.getVoices();
        const yesui = voices.find(v => v.name.includes('Yesui'));
        if (yesui) utterance.voice = yesui;
        utterance.lang = 'mn-MN';
        utterance.rate = 0.8;
        utterance.onend = () => el.classList.remove('playing');
        window.speechSynthesis.speak(utterance);
    }

    function startListening() {
        if (!currentWordElement) {
            alert("–≠—Ö–ª—ç—ç–¥ —É–Ω—à–∏—Ö “Ø–≥ –¥—ç—ç—Ä—ç—ç –¥–∞—Ä–∞–∞—Ä–∞–π!");
            return;
        }
        recognition.start();
        document.getElementById('mic-btn').classList.add('active');
        document.getElementById('status').innerText = "–°–æ–Ω—Å–æ–∂ –±–∞–π–Ω–∞... –•—ç–ª—ç—ç—Ä—ç–π!";
    }

    recognition.onresult = (event) => {
        const result = event.results[0][0].transcript.toLowerCase().trim();
        const target = currentWordElement.innerText.toLowerCase().trim().replace(/[.,-?]/g,"");
        
        document.getElementById('mic-btn').classList.remove('active');
        
        if (result.includes(target) || target.includes(result)) {
            currentWordElement.classList.add('correct');
            score += 10;
            document.getElementById('score').innerText = score;
            document.getElementById('status').innerText = "–ú—É–Ω–¥–∞–≥ –±–∞–π–Ω–∞! –ó”©–≤ —Ö—ç–ª–ª—ç—ç. üéâ";
            createStar();
        } else {
            document.getElementById('status').innerText = `–ß–∏ "${result}" –≥—ç–∂ —Ö—ç–ª–ª—ç—ç. –î–∞—Ö–∏–∞–¥ –æ—Ä–æ–ª–¥–æ–æ—Ä–æ–π!`;
        }
    };

    function createStar() {
        const star = document.createElement('div');
        star.className = 'star';
        star.innerText = '‚≠ê';
        star.style.left = Math.random() * window.innerWidth + 'px';
        star.style.top = window.innerHeight / 2 + 'px';
        document.body.appendChild(star);
        setTimeout(() => star.remove(), 1000);
    }

    startApp();
    window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();
</script>
</body>
</html>
